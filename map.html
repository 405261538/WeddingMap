<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <title>WeddingMap</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <link rel="preload" as="image" href="https://i.meee.com.tw/pFhTRSj.png">
    <link rel="stylesheet" href="styles.css">
    <script src="guests.js"></script>
    <script src="npcList.js"></script>
</head>

<body>
    <div id="Patronus-Charm" style="display: none;">
        <div>You are a muggle!!!</div>
    </div>
    <div id="loading-screen">
        <div class="loader">載入中...</div>
    </div>
    <div id="orientation-overlay">
        <div class="phone-icon"></div>
        <div>請將手機旋轉至橫向模式</div>
    </div>
    <div id="page-content" style="display:none;">
        <div class="scene">
            <div class="map">
                <div class="page left"></div>
                <div class="page right"></div>
            </div>
            <svg id="svgCanvas" viewBox="0 0 1920 2307" class="fullscreen-background"
                preserveAspectRatio="xMidYMid meet">
                <!-- 背景圖片 -->
                <image href="https://i.meee.com.tw/9LKkhVH.jpg" class="background" x="0" y="0" width="1920"
                    height="2307" />
                <image id="chair" href="https://i.meee.com.tw/rV2UGjU.png" x="730" y="1500" width="60" height="60"
                    preserveAspectRatio="none" visibility="hidden" />
                <g id="footprintArea"></g>

                <g id="refreshBtnGroup">
                    <image id="refreshBtn" href="https://i.meee.com.tw/Yjq634k.png" x="860" y="1925" width="200"
                        height="100" visibility="hidden" />
                </g>

                <!-- npc路線 -->
                <g id="npcGroup">
                    <path id="npc" fill="transparent" stroke="blue" stroke-width="2" d="" visibility="hidden" />
                    <defs>
                        <path id="npcArcPathDown" d="" fill="transparent" />
                        <path id="npcMotionPath" fill="transparent" d="" />
                    </defs>
                    <g id="npcRibbonGroup">
                        <!-- 前景圖片 -->
                        <image id="npcRibbon" href="https://i.meee.com.tw/5VqdeNQ.png" x="0" y="1925" width="200"
                            height="100" />
                        <!-- 文字沿向下弧形排列 -->
                        <text font-size="26" font-weight="bold" fill="#5C3426">
                            <textPath id="npcName" href="#npcArcPathDown" startOffset="50%" text-anchor="middle">
                            </textPath>
                        </text>
                        <!-- 沿路線移動動畫 -->
                        <animateMotion id="npcMotionAnim" dur="20s" repeatCount="1" begin="indefinite" fill="freeze">
                            <mpath href="#npcMotionPath" />
                        </animateMotion>
                    </g>
                </g>

                <!-- guest路線 -->
                <g id="guestGroup">
                    <path id="route" fill="transparent" stroke="black" stroke-width="2" d="" visibility="hidden" />
                    <defs>
                        <!--定義向下的弧形路徑 從左到右，弧形向下 -->
                        <path id="arcPathDown" d="M840,1967 A300,400 0 0,0 1080,1967" fill="transparent" />
                        <path id="motionPath" fill="transparent" d="" />
                    </defs>
                    <g id="ribbonGroup">
                        <!-- 前景圖片 -->
                        <image href="https://i.meee.com.tw/5VqdeNQ.png" class="ribbon" x="860" y="1925" width="200"
                            height="100" />

                        <!-- 文字沿向下弧形排列 -->
                        <text font-size="26" font-weight="bold" fill="#5C3426">
                            <textPath id="guestName" href="#arcPathDown" class="ribbon" startOffset="50%"
                                text-anchor="middle">
                            </textPath>
                        </text>
                        <!-- 沿路線移動動畫 -->
                        <animateMotion id="motionAnim" dur="20s" repeatCount="1" begin="indefinite" fill="freeze">
                            <mpath href="#motionPath" />
                        </animateMotion>
                    </g>
                </g>

                <g id="collegesGroup">
                    <image id="Slytherin" class="colleges" href="https://i.meee.com.tw/z6jyuTN.png" x="180" y="210"
                        width="300" height="200" opacity="0" />
                    <image id="Hufflepuff" class="colleges" href="https://i.meee.com.tw/KSE8csC.png" x="555" y="210"
                        width="300" height="200" opacity="0" />
                    <image id="Gryffindor" class="colleges" href="https://i.meee.com.tw/TdIjOoA.png" x="1060" y="210"
                        width="300" height="200" opacity="0" />
                    <image id="Ravenclaw" class="colleges" href="https://i.meee.com.tw/zmxSXuE.png" x="1440" y="210"
                        width="300" height="200" opacity="0" />
                </g>
                <g>
                    <!-- 第一個 Z -->
                    <text x="360" y="450" font-size="20" fill="#5C3426" text-anchor="middle" opacity="0">
                        Z
                        <animateTransform id="anim1-move" attributeName="transform" type="translate" from="0,0"
                            to="0,-150" dur="3s" repeatCount="indefinite" begin="indefinite" />
                        <animate id="anim1-size" attributeName="font-size" from="20" to="40" dur="3s"
                            repeatCount="indefinite" begin="indefinite" />
                        <animate id="anim1-opacity" attributeName="opacity" values="0;1;0" dur="3s"
                            repeatCount="indefinite" begin="indefinite" />
                    </text>

                    <!-- 第二個 Z -->
                    <text x="360" y="450" font-size="20" fill="#5C3426" text-anchor="middle" opacity="0">
                        Z
                        <animateTransform id="anim2-move" attributeName="transform" type="translate" from="0,0"
                            to="0,-150" dur="3s" repeatCount="indefinite" begin="indefinite" />
                        <animate id="anim2-size" attributeName="font-size" from="20" to="40" dur="3s"
                            repeatCount="indefinite" begin="indefinite" />
                        <animate id="anim2-opacity" attributeName="opacity" values="0;1;0" dur="3s"
                            repeatCount="indefinite" begin="indefinite" />
                    </text>

                    <!-- 第三個 Z -->
                    <text x="360" y="450" font-size="20" fill="#5C3426" text-anchor="middle" opacity="0">
                        Z
                        <animateTransform id="anim3-move" attributeName="transform" type="translate" from="0,0"
                            to="0,-150" dur="3s" repeatCount="indefinite" begin="indefinite" />
                        <animate id="anim3-size" attributeName="font-size" from="20" to="40" dur="3s"
                            repeatCount="indefinite" begin="indefinite" />
                        <animate id="anim3-opacity" attributeName="opacity" values="0;1;0" dur="3s"
                            repeatCount="indefinite" begin="indefinite" />
                    </text>
                </g>
                <g id="doorsGroup">
                    <g id="door-left-group" transform="rotate(0, 730, 2149)">
                        <image id="door-left" href="https://i.meee.com.tw/EhK8iZB.png" x="730" y="2149" width="227"
                            height="17" preserveAspectRatio="none" />
                    </g>
                    <g id="door-right-group">
                        <image id="door-right" href="https://i.meee.com.tw/EhK8iZB.png" x="957" y="2149" width="227"
                            height="17" preserveAspectRatio="none" />
                    </g>
                </g>

            </svg>

            <div class="line-vertical"></div>

            <!-- <img id="door-font" class="door-font" src="https://i.meee.com.tw/ZNb98qo.png"> -->
        </div>
    </div>
    <button id="fullscreenButton" style="display:none"></button>
    <script>

        class RouteManager {
            constructor(pathId, options = {}) {
                this.path = document.getElementById(pathId);
                this.footprintArea = document.getElementById("footprintArea");
                this.currentPosition = 0;
                this.isLeftFoot = true;
                this.footOffset = options.footOffset || 10;
                this.interval = null;
                this.loop = options.loop ?? true;
                this.speed = options.speed || 400; // ms
                this.ribbonGroup = document.getElementById(options.ribbonGroup) || null;
                this.motionAnim = document.getElementById(options.motionAnim) || null;
                this.onComplete = options.onComplete || null;
            }

            createFootprint(x, y, isLeft, rotation) {
                let footprint = document.createElementNS("http://www.w3.org/2000/svg", "image");
                footprint.setAttribute("href", isLeft ? "img/left-footprint.png" : "img/right-footprint.png");
                footprint.setAttribute("x", x);
                footprint.setAttribute("y", y);
                footprint.setAttribute("width", 25);
                footprint.setAttribute("height", 25);
                footprint.setAttribute("opacity", 1);
                footprint.setAttribute("class", "footprint");
                footprint.setAttribute("transform", `rotate(${rotation}, ${x + 12.5}, ${y + 12.5})`);

                this.footprintArea.appendChild(footprint);

                // 淡出 & 移除
                setTimeout(() => {
                    footprint.style.transition = "opacity 1s";
                    footprint.style.opacity = 0;
                    setTimeout(() => {
                        if (this.footprintArea.contains(footprint)) this.footprintArea.removeChild(footprint);
                    }, 1000);
                }, 2300);
            }

            updateFootprints() {
                if (!this.pathLength || this.pathLength <= 0) return;

                const safePos = Math.min(this.currentPosition, this.pathLength);
                const safeNext = Math.min(this.currentPosition + 5, this.pathLength);

                const point = this.path.getPointAtLength(safePos);
                const nextPoint = this.path.getPointAtLength(safeNext);

                let angle = Math.atan2(Math.round(nextPoint.y) - Math.round(point.y),
                    Math.round(nextPoint.x) - Math.round(point.x)) * (180 / Math.PI);

                // 平滑角度
                const furtherPoint = this.path.getPointAtLength(Math.min(this.currentPosition + 20, this.pathLength));
                let nextAngle = Math.atan2(Math.round(furtherPoint.y) - Math.round(nextPoint.y),
                    Math.round(furtherPoint.x) - Math.round(nextPoint.x)) * (180 / Math.PI);
                let angleDifference = nextAngle - angle;

                if (Math.abs(angleDifference) > 10) {
                    angle += angleDifference / 2;
                }

                let offsetX = Math.cos((angle + 90) * Math.PI / 180) * this.footOffset;
                let offsetY = Math.sin((angle + 90) * Math.PI / 180) * this.footOffset;

                let leftX = point.x - offsetX;
                let leftY = point.y - offsetY;
                let rightX = point.x + offsetX;
                let rightY = point.y + offsetY;
                let deviation = angle >= 90 ? 5 : 12;

                if (this.isLeftFoot) {
                    this.createFootprint(leftX - deviation, leftY - deviation, true, angle);
                } else {
                    this.createFootprint(rightX - deviation, rightY - deviation, false, angle);
                }

                this.isLeftFoot = !this.isLeftFoot;
                this.currentPosition += 25;

                if (this.currentPosition == this.pathLength) {
                    clearInterval(this.interval);
                    if (this.loop) {
                        setTimeout(() => this.startCycle(), 3000);
                    }
                    else if (this.onComplete) {
                        this.onComplete();
                    }
                }
                else if (this.currentPosition > this.pathLength - 25) {
                    this.currentPosition = this.pathLength - 25;
                }


            }

            startCycle() {
                this.currentPosition = 0;
                this.isLeftFoot = true;
                this.pathLength = this.path.getTotalLength();
                // ribbon 動畫
                if (this.motionAnim) {
                    // 計算 dur（和腳印步調一致）
                    const steps = Math.max(1, Math.ceil(this.pathLength / 25));
                    const totalTime = steps * this.speed; // 毫秒
                    this.motionAnim.setAttribute("dur", (totalTime / 1000) + "s");
                    this.motionAnim.beginElement();
                }

                clearInterval(this.interval);
                this.interval = setInterval(() => this.updateFootprints(), this.speed);
            }
        }

        const refreshBtn = $('#refreshBtn');
        const chair = $('#chair');
        const colleges = ["Slytherin", "Hufflepuff", "Gryffindor", "Ravenclaw"];
        const route = document.getElementById('route');
        const motionPath = document.getElementById('motionPath');
        const guestRoute = new RouteManager("route", {
            loop: false,
            speed: 400,
            ribbonGroup: "ribbonGroup",
            motionAnim: "motionAnim",
            onComplete: () => {
                chair.attr("visibility", "");
                setTimeout(function () {
                    refreshBtn.attr("visibility", "");
                }, 4000);
            }
        });
        const npcRoute = new RouteManager("npc", {
            loop: true,
            speed: 400,
            ribbonGroup: "npcRibbonGroup",
            motionAnim: "npcMotionAnim"
        });

        //#region 圖片載入檢核

        // 要檢查的圖片清單
        const requiredImages = [
            "https://i.meee.com.tw/pFhTRSj.png",
            "https://i.meee.com.tw/9LKkhVH.jpg",
            "img/left-footprint.png",
            "img/right-footprint.png"
        ];

        let loadedCount = 0;

        function checkAllLoaded() {
            if (loadedCount === requiredImages.length) {
                // 兩張圖片都載入完成 → 顯示內容
                document.getElementById("loading-screen").style.display = "none";
                document.getElementById("page-content").style.display = "block";

                // 背景淡入效果
                document.querySelector(".background").style.opacity = "1";
            }
        }

        requiredImages.forEach(src => {
            const img = new Image();
            img.src = src;

            img.onload = function () {
                loadedCount++;
                checkAllLoaded();
            };

            img.onerror = function () {
                console.error(src + " 載入失敗");
                loadedCount++;
                checkAllLoaded(); // 即使失敗也不要卡住
            };
        });
        //#endregion

        $(function () {

            // 初始化檢查
            checkOrientation();

            // 當螢幕方向改變時檢查
            window.addEventListener("orientationchange", checkOrientation);
            window.addEventListener("resize", checkOrientation);

            //封面翻頁
            $(".scene").on("click", function () {
                if ($(this).data("opened")) return;
                $(this).data("opened", true);

                // 停止左右頁的 wiggle 動畫
                $(".left, .right").css("animation", "none");
                $('#fullscreenButton').click();
                // 背景漸顯 & 縮回原比例
                $(".background").css({
                    "transform": "scale(1)",
                    "opacity": "1"
                });

                // 左頁翻開並淡出
                $(".left").animate(
                    { deg: -180 },
                    {
                        duration: 3500,
                        step: function (now) {
                            $(this).css("transform", "rotateY(" + now + "deg)");
                            // $(this).css("opacity", 1 - Math.abs(now) / 180);
                        }
                    }
                );

                // 右頁翻開並淡出
                $(".right").animate(
                    { deg: 180 },
                    {
                        duration: 3500,
                        step: function (now) {
                            $(this).css("transform", "rotateY(" + now + "deg)");
                            // $(this).css("opacity", 1 - Math.abs(now) / 180);
                        },
                        complete: function () {
                            npcRoute.startCycle();
                            openMap();
                        }
                    }
                );
            });

            let seatId = getSeatIdFromURL();
            if (seatId) {
                onScanQRCode(seatId);
            }

            //綁定refreshBtn mouseup事件
            refreshBtn.on('mouseup', () => {
                location.reload()
            });
        });

        //全螢幕按鈕
        $('#fullscreenButton').on('click', async function () {
            const el = document.documentElement;

            // 判斷 iOS
            const isIOS = /iP(hone|od|ad)/.test(navigator.platform) ||
                (navigator.userAgent.includes("Mac") && "ontouchend" in document);

            // 標準與前綴 API
            const rfs = el.requestFullscreen
                || el.webkitRequestFullscreen
                || el.mozRequestFullScreen
                || el.msRequestFullscreen;

            if (rfs) {
                try {
                    await rfs.call(el);
                    return;
                } catch (err) {
                    console.error('無法進入全螢幕模式:', err);
                }
            }

            // iPhone fallback：用 CSS/JS 模擬全螢幕
            if (isIOS) {
                // Fallback：視覺全螢幕
                document.body.style.height = window.innerHeight + 'px';
                document.documentElement.style.height = '100%';
                document.documentElement.style.overflow = 'hidden';
                document.body.classList.add('fullscreen-fallback');
            }
        });


        function openMap() {
            $('.map').hide();
            // 依序顯示學院
            colleges.forEach(function (id, index) {
                $('#' + id).animate({ opacity: 1 }, 500, function () {
                    floatElement(id); // 顯示完成後啟動漂浮
                });
            });

            // 總延遲等學院都出現完後再捲動場景
            setTimeout(function () {
                const scene = $(".scene")[0];
                const target = scene.scrollHeight - scene.clientHeight;

                $(".scene").css("overflow-y", "auto").animate(
                    { scrollTop: target },
                    3000, openDoors
                );
            }, 500 + 500);

            setTimeout(function () {
                $('.ribbon').css({
                    "opacity": "1"
                });

            }, 500 + 500 + 5000);

            setTimeout(function () {
                guestRoute.startCycle();
            }, 500 + 500 + 7000);
        }

        function openDoors() {
            // 左門往外開
            $("#door-left-group").animate(
                { deg: -15 },
                {
                    duration: 2000,
                    step: function (now) {
                        $(this).attr("transform", `rotate(${now}, 730, 2149)`);
                    }
                }
            );
        }

        // 取得 URL 參數
        function getSeatIdFromURL() {
            let params = new URLSearchParams(window.location.search);
            return params.get("id"); // 取得 ?id=xxx 的值
        }

        // 模擬掃描 QR Code
        function onScanQRCode(seatId) {
            let guest = guests.find(g => g.id == seatId);

            if (!guest) {
                $('#Patronus-Charm').show();
                return;
            }

            $('#guestName').text(guest.name);

            setGuest(seatId);
            setNpc(guest);
        }

        function setGuest(seatId) {
            const college = seatId[0];
            const tableNo = parseInt(seatId[1], 10);
            const seatNo = parseInt(seatId[2], 10);
            const leftSide = (college === "S" || college === "H"); // S/H → 往左, G/R → 往右
            const leftSideSeat = seatNo % 2 != 0;
            let targetY = calTargetY(tableNo, seatNo);

            setRoute(college, targetY, leftSide, leftSideSeat);
            setChair(college, targetY, leftSideSeat);
            refreshBtn.attr("y", targetY - 85);
        }

        function calTargetY(tableNo, seatNo) {
            let result = 495; //1桌 1、2位置高度

            //計算位置間距
            if (seatNo >= 5) {
                result += 140;
            }
            else if (seatNo >= 3) {
                result += 70;
            }

            //計算桌子間距
            result += (tableNo - 1) * 222
            if (tableNo > 3) result += 140; //4~5桌走道間距

            return result;
        }

        function setRoute(college, targetY, leftSide, leftSideSeat) {
            const originX = 960, originY = 2060;
            const motionY = targetY - originY; // motion Y 偏移
            let points = [[originX, originY]]; // 路線點 (svg 的絕對座標)
            let mPoints = [[0, 0]]; // motionPath 點 (相對座標)
            const sign = leftSide ? -1 : 1;
            const seatSign = leftSideSeat ? 1 : -1;

            if ((college === "H" && !leftSideSeat) || (college === "G" && leftSideSeat)) {
                // 垂直線 (origin → targetY)
                points.push([originX, targetY]);
                mPoints.push([0, motionY]);

                // 偏移 (往內 130, -30)
                points.push([originX + 130 * seatSign, targetY - 30]);
                mPoints.push([120 * seatSign, motionY - 30]);
            }
            else if ((college === "S" && leftSideSeat) || (college === "R" && !leftSideSeat)) {
                // 橫線 (origin → 左右 820px)
                points.push([originX + 820 * sign, originY]);
                mPoints.push([840 * sign, 0]);

                // 垂直線
                points.push([originX + 820 * sign, targetY]);
                mPoints.push([840 * sign, motionY]);

                // 偏移 (再往內 80, -30)
                points.push([originX + 820 * sign - 80 * sign, targetY - 30]);
                mPoints.push([840 * sign - 100 * sign, motionY - 30]);
            }
            else {
                // 橫線 (origin → 左右 820px)
                points.push([originX + 445 * sign, originY]);
                mPoints.push([445 * sign, 0]);

                // 垂直線 (origin → targetY)
                points.push([originX + 445 * sign, targetY]);
                mPoints.push([445 * sign, motionY]);

                // 偏移 (往內 80, -30)
                points.push([originX + 445 * sign + 80 * seatSign, targetY - 30]);
                mPoints.push([445 * sign + 80 * seatSign, motionY - 30]);
            }

            // 轉成 path 字串
            const routeD = "M" + points.map(p => p.join(" ")).join(" L");
            const motionD = "M" + mPoints.map(p => p.join(" ")).join(" L");

            route.setAttribute("d", routeD);
            motionPath.setAttribute("d", motionD);
        }

        function setChair(college, targetY, leftSideSeat) {
            let chairX = 0;

            if (college == "S") {
                chairX = leftSideSeat ? 213 : 388;
            }
            if (college == "H") {
                chairX = leftSideSeat ? 590 : 762;
            }
            if (college == "G") {
                chairX = leftSideSeat ? 1099 : 1271;
            }
            if (college == "R") {
                chairX = leftSideSeat ? 1473 : 1645;
            }

            chair.attr("x", chairX);
            chair.attr("y", targetY - 63);
            if (leftSideSeat) mirrorSVGImage('#chair', true);
        }

        function setNpc(guest) {
            let npc;

            if (guest.specNpc) {
                npc = npcList.find(x => x.name == guest.specNpc);
                if(npc.name == "Jira"){
                    npcRoute.loop = false;
                    npcRoute.onComplete = () => {
                        setTimeout(() => startZzz(), 3000);
                    }
                }
            }
            else {
                npc = pickRandomNPC();
            }

            let arcPathX = npc.ribbon.x - 20;
            let arcPathY = npc.ribbon.y + 42;

            $('#npcName').text(npc.name);
            $('#npc').attr("d", npc.route);
            $('#npcMotionPath').attr("d", npc.motionPath);
            $('#npcRibbon').attr("x", npc.ribbon.x);
            $('#npcRibbon').attr("y", npc.ribbon.y);
            $('#npcArcPathDown').attr("d",
                `M${arcPathX},${arcPathY} A300,400 0 0,0 ${arcPathX + 240},${arcPathY}`);
        }

        function pickRandomNPC() {
            const rand = Math.random(); // 0 ~ 1 之間
            let cumulative = 0;

            for (const npc of npcList) {
                cumulative += npc.chance;
                if (rand < cumulative) {
                    return npc;
                }
            }
            return npcList[0]; // 理論上不會發生，除非 chance 沒加總到 1
        }
        /**
         * 對 SVG image 做鏡像
         * @param {string} selector - jQuery 選擇器，例如 '#chair'
         * @param {boolean} horizontal - 是否水平鏡像
         * @param {boolean} vertical - 是否垂直鏡像
         */
        function mirrorSVGImage(selector, horizontal = false, vertical = false) {
            const img = $(selector);
            let x = parseFloat(img.attr('x')) || 0;
            let y = parseFloat(img.attr('y')) || 0;
            let w = parseFloat(img.attr('width')) || 0;
            let h = parseFloat(img.attr('height')) || 0;

            // 鏡像中心點
            let cx = x + w / 2;
            let cy = y + h / 2;

            let scaleX = horizontal ? -1 : 1;
            let scaleY = vertical ? -1 : 1;

            // 組合 transform
            let transformStr = `
                translate(${cx}, ${cy})
                scale(${scaleX}, ${scaleY})
                translate(${-cx}, ${-cy})
            `;

            img.attr('transform', transformStr);
        }

        //漂浮效果
        function floatElement(id) {
            const element = document.getElementById(id);
            const baseY = parseInt(element.getAttribute("y")); // 初始 y
            let direction = 1;  // 1=往下, -1=往上
            let offset = 0;
            const speed = 0.2; // 每幀移動幅度 (隨機速度)
            const maxOffset = 10 + Math.random() * 5; // 最大漂浮高度 (隨機範圍)

            function animate() {
                offset += direction * speed;
                if (offset > maxOffset || offset < -maxOffset) {
                    direction *= -1; // 到邊界就反向
                }
                element.setAttribute("y", baseY + offset);

                // 用 requestAnimationFrame 讓每個學院獨立漂浮
                requestAnimationFrame(animate);
            }

            // 啟動動畫
            requestAnimationFrame(animate);
        }

        /*檢核手機轉向*/
        function checkOrientation() {
            const overlay = document.getElementById('orientation-overlay');

            if (window.matchMedia("(orientation: portrait)").matches) {
                overlay.classList.add("show"); // 顯示遮罩 (淡入)
                document.body.style.overflow = "hidden"; // 禁止滾動
            } else {
                overlay.classList.remove("show"); // 隱藏遮罩 (淡出)
                document.body.style.overflow = "auto"; // 恢復滾動
            }

            let vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
        }

        function startZzz() {
            // 依序延遲播放 (0s, 1s, 2s)
            setTimeout(() => {
                document.getElementById("anim1-move").beginElement();
                document.getElementById("anim1-size").beginElement();
                document.getElementById("anim1-opacity").beginElement();
            }, 0);

            setTimeout(() => {
                document.getElementById("anim2-move").beginElement();
                document.getElementById("anim2-size").beginElement();
                document.getElementById("anim2-opacity").beginElement();
            }, 1000);

            setTimeout(() => {
                document.getElementById("anim3-move").beginElement();
                document.getElementById("anim3-size").beginElement();
                document.getElementById("anim3-opacity").beginElement();
            }, 2000);
        }
    </script>

</body>

</html>